/*! @bluemango/slp-helper v1.5.3 - 2018/03/22 */
!function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,o){"use strict";function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e};window.lemonpi=window.lemonpi||[],function(){var e="padding:1px 6px 0;border-radius:2px;background:#fbde00;color:#444;",t={booleans:["available"],numbers:["advertiserId","dynamicInputId"],strings:["category","clickUrl","custom1","custom2","custom3","custom4","description","expiresOn","id","imageUrl","logoUrl","priceDiscount","priceNormal","stickerText","title","type"],required:["advertiserId","dynamicInputId","imageUrl","title"]},o=t.booleans.concat(t.numbers,t.strings),a={debug:/lemonpi_debug/.test(window.location.href),optionalFields:[],interval:500},c=void 0,s=void 0,d=void 0,l=void 0,u=void 0,f=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];for(var n=JSON.stringify(t),r=0,i=void 0,a=0;a<n.length;a+=1)i=n.charCodeAt(a),r=(r<<5)-r+i,r|=0;return r.toString()},p=function(){var e=document.body.getBoundingClientRect(),t=f(e,l);return u!==t&&(u=t,!0)},g=function(e){var t=e;if("string"==typeof e&&(t=document.querySelector(e)),t){var o=window.getComputedStyle(t).getPropertyValue("background-image").replace(/url\(['"]?|['"]?\)/g,"");return"none"===o?void 0:o}},m=function(t,o){console.log("%cSLP%c "+t+"%c "+o,e,"color:red;font-weight:bold;","color:red;")},b=function(e){return window.location.pathname.split("/").filter(function(e){return e}).map(function(e){return decodeURI(e)})[e]},y=function(e){return window.location.search.replace(/^\?/,"").split("&").filter(function(e){return e}).reduce(function(e,t){return i(e,n({},decodeURI(t.split("=")[0]),decodeURI(t.split("=")[1])))},{})[e]},v=function(e,t){var o=void 0;try{o=t()}catch(t){s[e]||-1!==a.optionalFields.indexOf(e)||(s[e]=t.message)}return o},h=function(e){var t=window.location.protocol+"//"+window.location.host+window.location.pathname;if(e){var o=!1;if(e.allowedParameters&&e.allowedParameters.length&&e.allowedParameters.forEach(function(e){var n=o?"&":"?",r=encodeURI(e),i=y(e);void 0!==i&&(t+=""+n+r+"="+encodeURI(i),o=!0)}),e.customParameters){Object.keys(e.customParameters).forEach(function(n){var r=o?"&":"?",i=encodeURI(n),a=encodeURI(e.customParameters[n]);t+=""+r+i+"="+a,o=!0})}e.hash&&(t+=window.location.hash)}return t},w=function(e,o){var n=o;switch("function"==typeof n&&(n=v(e,n)),void 0===n?"undefined":r(n)){case"boolean":s[e]||-1!==t.booleans.indexOf(e)||(s[e]="doesn't expect a boolean value");break;case"number":s[e]||-1!==t.numbers.indexOf(e)||(s[e]="doesn't expect a number value");break;case"string":switch(n=n.replace(/\s+/g," ").trim(),s[e]||-1!==t.strings.indexOf(e)||(s[e]="doesn't expect a string value"),e){case"category":case"id":;n=n.toLowerCase().replace(/[^\da-z]/g,function(e){return"aaaaaaoooooooeeeecdiiiiuuuuunsyyz"["àáâãäåòóôõöőøèéêëçðìíîïùúûüűñšÿýž".indexOf(e)]||" "}).trim().replace(/\s+/g,"-");break;case"clickUrl":case"imageUrl":case"logoUrl":s[e]||/^https?:\/\//.test(n)||(s[e]="should be a URL and start with 'http://' or 'https://'");break;case"expiresOn":s[e]||"Invalid Date"!==new Date(n).toString()||(s[e]="should be an ISO 8601 formatted datetime string");break;case"type":s[e]||-1!==["propInBasket","propPurchased","propSeen"].indexOf(n)||(s[e]="should be 'propSeen', 'propInBasket', or 'propPurchased'")}break;case"undefined":-1!==a.optionalFields.indexOf(e)||s[e]||(s[e]="is undefined");break;default:s[e]||(s[e]="can't be of type "+(void 0===n?"undefined":r(n)))}return n},O=function n(r,u){if(c={},s={},r.config){if(r.config.longestViewed&&(a.interval=1e3),i(a,r.config),a.testUrl&&a.testUrl.test&&!a.testUrl.test(window.location.href))return void(a.debug&&m("The URL","doesn't match '"+a.testUrl.toString()+"'"));a.longestViewed&&document.addEventListener("mousemove",function(e){l=[e.pageX,e.pageY]})}Object.keys(r).forEach(function(e){-1!==o.indexOf(e)&&(c[e]=w(e,r[e]))}),Object.keys(c).forEach(function(e){void 0!==c[e]&&""!==c[e]||(delete c[e],s[e]||-1!==a.optionalFields.indexOf(e)||(s[e]="is empty"))}),-1!==["propInBasket","propPurchased"].indexOf(c.type)&&(t.required=["id","advertiserId","dynamicInputId"]),t.required.forEach(function(e){s[e]||-1!==Object.keys(c).indexOf(e)||(s[e]="is required and missing")});var g=f(c);if(g!==d||a.longestViewed&&p())if(d=g,c.type||(c.type="propSeen"),"propSeen"===c.type&&(c.id||(c.id=g),c.category||(c.category="none"),void 0===c.available&&(c.available=!0),c.clickUrl||(c.clickUrl=h())),a.debug&&Object.keys(s).forEach(function(e){m(e,s[e])}),Object.keys(s).length)a.debug&&console.log("%cSLP%c Scrape unsuccessful:",e,"color:red;",c);else if(a.debug&&console.log("%cSLP%c Scrape successful:",e,"color:green;",c),u?u(c):window.lemonpi.push(c),!a.watchChanges&&!a.longestViewed)return;setTimeout(function(){n(r)},a.interval)};window.slp=window.slp||{getBackgroundImageUrl:g,getUrlQueryParameter:y,getUrlPathSegment:b,generateHash:f,getUrl:h,scrape:O}}()}]);