/*! slp-helper v1.9.0 - 2018/09/19 */
!function(e){function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}var t={};r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=0)}([function(e,r,t){"use strict";function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};window.lemonpi=window.lemonpi||[],function(){var e="padding:1px 6px 0;border-radius:2px;background:#fbde00;color:#444",r={booleans:["available"],numbers:["advertiserId","dynamicInputId"],strings:["category","clickUrl","custom1","custom2","custom3","custom4","description","expiresOn","id","imageUrl","logoUrl","priceDiscount","priceNormal","stickerText","title","type"],required:["advertiserId","dynamicInputId","imageUrl","title"]},t=r.booleans.concat(r.numbers,r.strings),s={debug:/lemonpi_debug/.test(window.location.href),optionalFields:[],interval:500},a=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];for(var o=JSON.stringify(r),n=0,i=void 0,s=0;s<o.length;s+=1)i=o.charCodeAt(s),n=(n<<5)-n+i,n|=0;return n.toString()},c=function(e){var r=e;if("string"==typeof e&&(r=document.querySelector(e)),r){var t=window.getComputedStyle(r).getPropertyValue("background-image").replace(/url\(['"]?|['"]?\)/g,"");return"none"===t?void 0:t}},u=function(r,t){console.log("%cSLP%c "+r+"%c "+t,e,"color:red;font-weight:bold","color:red")},l=function(e,r){var t="string"==typeof r?r:JSON.stringify(r);document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)},d=function(e){var r="; "+document.cookie,t=r.split("; "+e+"=");if(2===t.length){var o=decodeURIComponent(t.pop().split(";").shift());try{o=JSON.parse(o)}catch(e){}return o}},f=function(){return window.location.pathname.split("/").filter(function(e){return e}).map(function(e){return decodeURI(e)})},p=function(e){return f()[e]},g=function(){return window.location.search.replace(/^\?/,"").split("&").filter(function(e){return e}).reduce(function(e,r){return i(e,o({},decodeURI(r.split("=")[0]),decodeURI(r.split("=")[1])))},{})},h=function(e){return g()[e]},m=function(e){var r=window.location.protocol+"//"+window.location.host+window.location.pathname;if(e){var t=!1;if(e.allowedParameters&&e.allowedParameters.length&&e.allowedParameters.forEach(function(e){var o=t?"&":"?",n=encodeURI(e),i=h(e);void 0!==i&&(r+=""+o+n+"="+encodeURI(i),t=!0)}),e.customParameters){Object.keys(e.customParameters).forEach(function(o){var n=t?"&":"?",i=encodeURI(o),s=encodeURI(e.customParameters[o]);r+=""+n+i+"="+s,t=!0})}(e.hash||e.allowHash)&&(r+=window.location.hash)}return r},b=function(o,c){var l=this;if(this.config=i({},s),this.input=o,this.callback=c,this.result={},this.errors=[],this.pointerCoords=[],this.lastScrapedHash="",this.interactedStateHash="",this.getUserInteracted=function(){var e=document.body.getBoundingClientRect(),r=a(e,l.pointerCoords);return l.interactedStateHash!==r&&(l.interactedStateHash=r,!0)},this.handleFunction=function(e,r){var t=void 0;try{t=r()}catch(r){l.errors[e]||-1!==l.config.optionalFields.indexOf(e)||(l.errors[e]=r.message)}return t},this.getValue=function(e,t){var o=t;switch("function"==typeof o&&(o=l.handleFunction(e,o)),void 0===o?"undefined":n(o)){case"boolean":l.errors[e]||-1!==r.booleans.indexOf(e)||(l.errors[e]="doesn't expect a boolean value");break;case"number":l.errors[e]||-1!==r.numbers.indexOf(e)||(l.errors[e]="doesn't expect a number value");break;case"string":switch(o=o.replace(/\s+/g," ").trim(),l.errors[e]||-1!==r.strings.indexOf(e)||(l.errors[e]="doesn't expect a string value"),e){case"category":case"id":;o=o.toLowerCase().replace(/[^\da-z]/g,function(e){return"aaaaaaoooooooeeeecdiiiiuuuuunsyyz"["àáâãäåòóôõöőøèéêëçðìíîïùúûüűñšÿýž".indexOf(e)]||" "}).trim().replace(/\s+/g,"-");break;case"clickUrl":case"imageUrl":case"logoUrl":l.errors[e]||/^https?:\/\//.test(o)||(l.errors[e]="should be a URL and start with 'http://' or 'https://'");break;case"expiresOn":l.errors[e]||"Invalid Date"!==new Date(o).toString()||(l.errors[e]="should be an ISO 8601 formatted datetime string");break;case"type":l.errors[e]||-1!==["propInBasket","propPurchased","propSeen"].indexOf(o)||(l.errors[e]="should be 'propSeen', 'propInBasket', or 'propPurchased'")}break;case"undefined":-1!==l.config.optionalFields.indexOf(e)||l.errors[e]||(l.errors[e]="is undefined");break;default:l.errors[e]||(l.errors[e]="can't be of type "+(void 0===o?"undefined":n(o)))}return o},this.scrape=function(){l.result={},l.errors={},Object.keys(l.input).forEach(function(e){-1!==t.indexOf(e)&&(l.result[e]=l.getValue(e,l.input[e]))}),Object.keys(l.result).forEach(function(e){void 0!==l.result[e]&&""!==l.result[e]||(delete l.result[e],l.errors[e]||-1!==l.config.optionalFields.indexOf(e)||(l.errors[e]="is empty"))}),-1!==["propInBasket","propPurchased"].indexOf(l.result.type)&&(r.required=["id","advertiserId","dynamicInputId"]),r.required.forEach(function(e){l.errors[e]||-1!==Object.keys(l.result).indexOf(e)||(l.errors[e]="is required and missing")});var o=a(l.result);if(o!==l.lastScrapedHash||l.config.longestViewed&&l.getUserInteracted())if(l.lastScrapedHash=o,l.result.type||(l.result.type="propSeen"),"propSeen"===l.result.type&&(l.result.id||(l.result.id=o),l.result.category||(l.result.category="none"),void 0===l.result.available&&(l.result.available=!0),l.result.clickUrl||(l.result.clickUrl=m())),l.config.debug&&Object.keys(l.errors).forEach(function(e){u(e,l.errors[e])}),Object.keys(l.errors).length)l.config.debug&&console.log("%cSLP%c Scrape unsuccessful:",e,"color:red",l.result);else{if(l.config.debug&&console.log("%cSLP%c Scrape successful:",e,"color:green",l.result),l.callback?l.callback(l.result):window.lemonpi.push(l.result),!l.config.watchChanges&&!l.config.longestViewed)return;l.input.config.longestViewed&&(l.config.interval=5e3)}setTimeout(function(){l.scrape()},l.config.interval)},this.input.config&&(this.input.config.longestViewed&&document.addEventListener("mousemove",function(e){l.pointerCoords=[e.pageX,e.pageY]}),i(this.config,this.input.config),this.config.testUrl&&this.config.testUrl.test&&!this.config.testUrl.test(window.location.href)))return void(this.config.debug&&u("The URL","doesn't match '"+this.config.testUrl.toString()+"'"));this.scrape()};window.slp=window.slp||{getBackgroundImageUrl:c,getUrlQueryParameters:g,getUrlQueryParameter:h,getUrlPathSegments:f,getUrlPathSegment:p,generateHash:a,setCookie:l,getCookie:d,getUrl:m,scrape:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return new(Function.prototype.bind.apply(b,[null].concat(r)))}}}()}]);